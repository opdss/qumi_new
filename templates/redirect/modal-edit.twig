
<div class="modal-header">
    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
    <h4 class="modal-title">修改跳转记录</h4>
</div>
<div class="modal-body">
    <form class="form-horizontal modal-form">
        <div class="form-group">
            <label for="description" class="col-sm-2 control-label">转发标题</label>
            <div class="col-sm-8">
                <input class="form-control" rows="3" name="title" value="{{ detail.title }}" placeholder="转发标题"/>
            </div>
        </div>

        <div class="form-group">
            <label for="name" class="col-sm-2 control-label">源地址</label>
            <div class="col-sm-5">
                <div class="input-group">
                    <div class="input-group-addon">前缀</div>
                    <input type="text" class="form-control" id="prefix" name="prefix" value="{{ detail.prefix }}">
                    {#<div class="input-group-addon">.</div>#}
                </div>
            </div>
            <div class="col-sm-4">
                <select class="selectpicker col-md-12" data-live-search="true" name="domain_id">
                    <option value="0">选择域名</option>
                    {% for x in domains %}
                        <option value="{{ x.id }}" {{ detail.domain_id == x.id ? 'selected' : '' }}>{{ x.name }}</option>
                    {% endfor %}
                </select>
            </div>
        </div>

        <div class="form-group">
            <label for="description" class="col-sm-2 control-label">目标地址</label>
            <div class="col-sm-8">
                <input class="form-control" name="redirect_url" placeholder="" value="{{ detail.redirect_url }}"/>
            </div>
        </div>

        <div class="form-group price-group">
            <label for="price" class="col-sm-2 control-label">跳转类型</label>
            <div class="col-sm-4">
                <select class="selectpicker" name="redirect_status">
                    <option value="301" {{ detail.redirect_status == 301 ? 'selected' : '' }}>301</option>
                    <option value="302" {{ detail.redirect_status == 302 ? 'selected' : '' }}>302</option>
                </select>
            </div>
        </div>
        <input type="hidden" name="redirect_id"  value="{{ detail.id }}">
    </form>
</div>
<div class="modal-footer">
    <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
    <button type="button" class="btn btn-primary modal-submit">确认</button>
</div>
<script type="text/javascript">
    (function () {
        $('.selectpicker').selectpicker();
        $('.modal-submit').click(function () {
            var modalObj = $(this).parents('div.modal');
            var form = modalObj.find('form.modal-form');
            $.post('{{ path_for('redirect.update') }}', form.serialize(), function(res){
                if (res.errCode == 0) {
                    modalObj.modal('hide');
                    utils.swal.success('', true);
                } else {
                    utils.swal.error(res.errMsg);
                }
            })
        })
    })()
</script>